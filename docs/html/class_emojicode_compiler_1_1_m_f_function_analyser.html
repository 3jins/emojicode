<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Emojicode: EmojicodeCompiler::MFFunctionAnalyser Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Emojicode
   &#160;<span id="projectnumber">0.6</span>
   </div>
   <div id="projectbrief">World’s only programming language that’s bursting with emojis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_emojicode_compiler.html">EmojicodeCompiler</a></li><li class="navelem"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html">MFFunctionAnalyser</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_emojicode_compiler_1_1_m_f_function_analyser-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">EmojicodeCompiler::MFFunctionAnalyser Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_m_f_function_analyser_8hpp_source.html">MFFunctionAnalyser.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa7b24d59aebb55b4f865bd13d198dd51"><td class="memItemLeft" align="right" valign="top"><a id="aa7b24d59aebb55b4f865bd13d198dd51"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MFFunctionAnalyser</b> (<a class="el" href="class_emojicode_compiler_1_1_function.html">Function</a> *function)</td></tr>
<tr class="separator:aa7b24d59aebb55b4f865bd13d198dd51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb643add45ee205dcab77ed8ce6b95a"><td class="memItemLeft" align="right" valign="top"><a id="a5fb643add45ee205dcab77ed8ce6b95a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a5fb643add45ee205dcab77ed8ce6b95a">analyse</a> ()</td></tr>
<tr class="memdesc:a5fb643add45ee205dcab77ed8ce6b95a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyses the function for which this <a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html">MFFunctionAnalyser</a> was created. This method must only be called once. <br /></td></tr>
<tr class="separator:a5fb643add45ee205dcab77ed8ce6b95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfc6b8337cff2fb08a2965969ca83d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a8bfc6b8337cff2fb08a2965969ca83d4">take</a> (<a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *expr)</td></tr>
<tr class="separator:a8bfc6b8337cff2fb08a2965969ca83d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497cd4b0c8380fed16019640a103ee41"><td class="memItemLeft" align="right" valign="top"><a id="a497cd4b0c8380fed16019640a103ee41"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a497cd4b0c8380fed16019640a103ee41">recordThis</a> (<a class="el" href="namespace_emojicode_compiler.html#ad83ac4c651ceaca8ea913b363901284d">MFFlowCategory</a> category)</td></tr>
<tr class="memdesc:a497cd4b0c8380fed16019640a103ee41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the flow category of a use of the context. <br /></td></tr>
<tr class="separator:a497cd4b0c8380fed16019640a103ee41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a422e6fd3356ad1c51469795373b5d462"><td class="memItemLeft" align="right" valign="top"><a id="a422e6fd3356ad1c51469795373b5d462"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a422e6fd3356ad1c51469795373b5d462">recordVariableGet</a> (size_t id, <a class="el" href="namespace_emojicode_compiler.html#ad83ac4c651ceaca8ea913b363901284d">MFFlowCategory</a> category)</td></tr>
<tr class="memdesc:a422e6fd3356ad1c51469795373b5d462"><td class="mdescLeft">&#160;</td><td class="mdescRight">Records the flow category of the use of a variable value. <br /></td></tr>
<tr class="separator:a422e6fd3356ad1c51469795373b5d462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d89da23f74baf7dd415e51de7ded3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a72d89da23f74baf7dd415e51de7ded3f">recordVariableSet</a> (size_t id, <a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *expr, <a class="el" href="class_emojicode_compiler_1_1_type.html">Type</a> type)</td></tr>
<tr class="separator:a72d89da23f74baf7dd415e51de7ded3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1284228c0bdd54ce20c3cf6bf22d99fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a1284228c0bdd54ce20c3cf6bf22d99fb">recordReturn</a> (<a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *expr)</td></tr>
<tr class="separator:a1284228c0bdd54ce20c3cf6bf22d99fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b29257fc980e029197fc372deea0480"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#a6b29257fc980e029197fc372deea0480">analyseFunctionCall</a> (<a class="el" href="class_emojicode_compiler_1_1_a_s_t_arguments.html">ASTArguments</a> *node, <a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *callee, <a class="el" href="class_emojicode_compiler_1_1_function.html">Function</a> *function)</td></tr>
<tr class="separator:a6b29257fc980e029197fc372deea0480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae92ad7f2c00751e264f20fc8b8d82f87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html#ae92ad7f2c00751e264f20fc8b8d82f87">popScope</a> (<a class="el" href="class_emojicode_compiler_1_1_a_s_t_block.html">ASTBlock</a> *block)</td></tr>
<tr class="separator:ae92ad7f2c00751e264f20fc8b8d82f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class is responsible for analysing the memory flow of a function.</p>
<p>Memory flow analysis is not an optimization step but an integral part of Emojicode memory management.</p>
<p>When analysing memory flow, Emojicode divides every use of a value into two <em>flow categories</em>:</p><ul>
<li>Borrowing Use: The value is never used in a way that could let the value escape. "Escape" means any action that makes the value available outside stack memory, e.g. an instance variable assignment or otherwise storing the value into heap memory. Note that this does not indicate whether the object will ever be retained or not.</li>
<li>Escaping Use: The value could escape as described above. This category is also used if the compiler cannot say for sure that the use of the value is Borrowing.</li>
</ul>
<p>In order to classify all uses of a value as accurately as possible, <a class="el" href="class_emojicode_compiler_1_1_m_f_function_analyser.html">MFFunctionAnalyser</a> exists. One of its key jobs is to determine the flow category of every parameter and to set the MFFlowCategory of every parameter.</p>
<p>The flow category can then be used to perform certain optimization like allocating values on the stack instead of on the heap.</p>
<p>Furthemore, to manage allocation Emojicode distinguishes every value created into two <em>value categories</em>:</p><ul>
<li>Temporary Value: The value is only retained for the duration of the statement. It is to be released at the end of the statement. For example, an object created and immediately passed as an argument will be released at the end of the statement. A temporary value, however, is not necessarily created by initialization. Retrieving a variable also creates a temporary value.</li>
<li>Taken Value: A taken value does not need to be released at the end of the statement. This, for instance, is the case if the value was assigned to a variable.</li>
</ul>
<p>There is no direct connection between the <em>value category</em> and the <em>flow category</em> of a value. All combinations of the categories are possible. For example, a temporary value could be passed to a Borrowing or an Escaping parameter, while a taken value could be a value assigned to an instance variable (escaping) or to a constant local variable (borrowing). </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a6b29257fc980e029197fc372deea0480"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b29257fc980e029197fc372deea0480">&#9670;&nbsp;</a></span>analyseFunctionCall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EmojicodeCompiler::MFFunctionAnalyser::analyseFunctionCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_arguments.html">ASTArguments</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *&#160;</td>
          <td class="paramname"><em>callee</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_function.html">Function</a> *&#160;</td>
          <td class="paramname"><em>function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Analyses a function call. Analyses the callee and arguments with the appropriate flow category. If the specified function was not memory flow analysed, analyses the function first. </p>

</div>
</div>
<a id="ae92ad7f2c00751e264f20fc8b8d82f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae92ad7f2c00751e264f20fc8b8d82f87">&#9670;&nbsp;</a></span>popScope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EmojicodeCompiler::MFFunctionAnalyser::popScope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_block.html">ASTBlock</a> *&#160;</td>
          <td class="paramname"><em>block</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method must be called after having analysed an <a class="el" href="class_emojicode_compiler_1_1_a_s_t_block.html">ASTBlock</a>. It appropriately releases variable values, updates the MFFlowCategory of parameters and converts heap into stack allocations. </p>

</div>
</div>
<a id="a1284228c0bdd54ce20c3cf6bf22d99fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1284228c0bdd54ce20c3cf6bf22d99fb">&#9670;&nbsp;</a></span>recordReturn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EmojicodeCompiler::MFFunctionAnalyser::recordReturn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *&#160;</td>
          <td class="paramname"><em>expr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Informs the analyser that the expression will be returned from the function. expr will be marked as Escaping and as a Taken Value. </p>

</div>
</div>
<a id="a72d89da23f74baf7dd415e51de7ded3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d89da23f74baf7dd415e51de7ded3f">&#9670;&nbsp;</a></span>recordVariableSet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EmojicodeCompiler::MFFunctionAnalyser::recordVariableSet </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *&#160;</td>
          <td class="paramname"><em>expr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_type.html">Type</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Records an expression whose resulting value was assigned to a variable. If the compiler can prove that the variable value is never used in an Escaping manner it will inform the expression that it can allocate on the heap if it inherits from <a class="el" href="class_emojicode_compiler_1_1_m_f_heap_allocates.html">MFHeapAllocates</a>. Analyses expr as Escaping. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The type of the variable. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8bfc6b8337cff2fb08a2965969ca83d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bfc6b8337cff2fb08a2965969ca83d4">&#9670;&nbsp;</a></span>take()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EmojicodeCompiler::MFFunctionAnalyser::take </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_emojicode_compiler_1_1_a_s_t_expr.html">ASTExpr</a> *&#160;</td>
          <td class="paramname"><em>expr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Marks the value that is created by the expression as a Taken Value. </p><dl class="section note"><dt>Note</dt><dd>This method does not affect the flow category of the value. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/theo/Documents/emojicode/emojicode/Compiler/MemoryFlowAnalysis/<a class="el" href="_m_f_function_analyser_8hpp_source.html">MFFunctionAnalyser.hpp</a></li>
<li>/Users/theo/Documents/emojicode/emojicode/Compiler/MemoryFlowAnalysis/MFFunctionAnalyser.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
